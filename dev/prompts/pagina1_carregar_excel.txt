PROMPT — STREAMLIT (PÁGINA 1)
UPLOAD EXCEL + VARREDURA (LINHAS × COLUNAS) + TABELA RESUMO POR ABA + CONSOLIDAÇÃO + CSV BRUTO ÚNICO COM COLUNA aba

Você é um desenvolvedor Python especialista em Streamlit e deve implementar a Página 1 (“Upload e Conversão”) de um app.
Esta página é exclusivamente responsável por carregar um arquivo Excel e gerar um CSV consolidado bruto.
Tratamento de cabeçalho/normalização/limpeza será feito em outra página.

1) ESCOPO

A Página 1 deve:

Permitir upload de Excel (.xlsx e .xls).

Varrer todas as abas do arquivo.

Para cada aba, medir:

Número de linhas

Número de colunas

Status: ok | empty | error

Exibir cada aba em st.expander com:

Linhas, colunas, status

Prévia bruta head(N) se ok

Consolidar todas as abas ok em um DataFrame único df_all, empilhando (concat) e inserindo a coluna obrigatória aba.

Gerar um único CSV bruto e liberar download na própria Página 1.

2) TABELA RESUMO FINAL (OBRIGATÓRIA E SIMPLES)

Quando o carregamento terminar, antes do download, o app deve mostrar uma tabela simples (DataFrame) com exatamente estas colunas, nesta ordem:

aba (nome da aba)

linhas (número de linhas)

colunas (número de colunas)

Regras:

Cada linha da tabela corresponde a uma aba do Excel.

A tabela deve incluir todas as abas detectadas, mesmo as vazias ou com erro:

Se error, linhas e colunas devem ser 0 e o status fica registrado internamente (ou opcionalmente exibido fora da tabela, mas a tabela deve permanecer com 3 colunas apenas).

A primeira coluna chama aba e contém o nome da aba (não usar índice oculto como “nome da aba”; o nome precisa estar na coluna).

Além da tabela, exibir logo abaixo (texto simples):

Total de linhas no CSV consolidado: <N_total>

Total de colunas no CSV consolidado: <M_total> (opcional, mas útil)

Contagem de abas usadas na consolidação: ok = X, empty = Y, error = Z

3) CONSOLIDAÇÃO (CSV ÚNICO)

Criar df_all concatenando todas as abas com status ok.

Para cada aba ok, adicionar coluna aba com o nome da aba.

Não tratar cabeçalho, não renomear colunas, não limpar valores.

Permitir união de colunas (abas com schemas diferentes).

O CSV final deve ser:

df_all.to_csv(...)

Nome sugerido: <nome_arquivo>__consolidado_bruto.csv

4) RESTRIÇÕES

Nada de tratamento de cabeçalho nesta página.

Nada de padronização de colunas.

Nada de interpretação semântica.

A página termina quando o usuário consegue baixar o CSV consolidado bruto e visualiza o resumo por aba + total de linhas do consolidado.

5) SESSION_STATE (OBRIGATÓRIO)

Persistir:

excel_bytes

sheets_info com rows, cols, status, errors

df_all

csv_all_bytes

df_resumo_abas (a tabela de 3 colunas)
